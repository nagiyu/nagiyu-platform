# 意思決定ログ

## 2026-02-17: 一括登録の件数バリデーション修正における設計判断

### 決定1: 方針3（`selectRandomVideos` の新設）を採用

- **決定内容**: フィルタ済み動画一覧の取得責務と、ランダム抽出責務を分離する
- **理由**:
    - 既存機能への影響を最小化しやすい
    - ランダム抽出の意図をユースケース単位で明確化できる
    - テスト観点を分離しやすく、保守性が高い

### 決定2: ランダム抽出に Reservoir Sampling を採用

- **決定内容**: 一括登録時の動画選択は Reservoir Sampling で行う
- **理由**:
    - フィルタ後の全母集団を公平に抽出対象にできる
    - 必要件数のみ保持するため、不要な全件シャッフルを避けられる
    - 一括登録の要件（最大100件）に対して実装コストと効果のバランスが良い

### 決定3: `listVideosWithSettings` の `limit` 既定値を変更

- **決定内容**: `limit` 未指定時の既定値を固定件数から「全件取得」へ変更
- **理由**:
    - 一括登録で「フィルタ後の全件を母集団にする」要件を満たすため
    - 既存の主要呼び出しは件数指定を明示しており、挙動変更の影響を局所化できるため
